---
import data from '../../../data/data';
import Layout from '../../../layouts/Layout.astro';
import TextCardGrid from '../../../templates/text-card-grid';
import ImageCardGrid from '../../../templates/image-card-grid';

export function getStaticPaths() {
  const base = '/wymiana-baterii/';
  return data.map((item: any) => {
    const { slug, phones, categories, categoryTitle, name } = item;
    return {
      params: { brand: slug.slice(0, slug.length - 1) },
      props: {
        name,
        models: phones ? phones.map((phone: any) => ({ name: phone.name, slug: `${base}${slug}${phone.slug}` })) : undefined,
        categories: categories ? categories.map((category: any) => ({
          ...category,
          slug: category.slug.startsWith('/') ? category.slug.replace(/\/offer\//, base) : `${base}${slug}${category.slug}`,
        })) : undefined,
        categoryTitle: categoryTitle || undefined,
      },
    };
  });
}

const { models, categories, categoryTitle, name } = Astro.props;
---

<Layout title={name}>
  {models && <TextCardGrid headerContent="Wybierz model" data={models} />}
  {categories && <ImageCardGrid headerContent={categoryTitle || "Wybierz seriÄ™"} data={categories as any} />}
</Layout>
